<! DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenLoad | Fast YouTube Downloader</title>
    <meta name="description" content="Download YouTube Videos and Shorts in one click. Free, fast, and secure.">
    
    <style>
        /* CSS VARIABLES & RESET */
        :root {
            --bg-color: #0f1115;
            --card-bg: #181b21;
            --text-main: #ffffff;
            --text-muted: #8b9bb4;
            --accent:  #3b82f6; /* Blue */
            --accent-hover: #2563eb;
            --success: #10b981;
            --error: #ef4444;
            --border:  #2d3342;
            --radius: 12px;
            --font:  -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color:  transparent; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* LAYOUT & TYPOGRAPHY */
        .container {
            width: 100%;
            max-width: 500px;
            margin-top: 40px;
            text-align: center;
        }

        h1 { font-size: 28px; font-weight: 800; letter-spacing: -0.5px; margin-bottom: 8px; }
        . logo-accent { color: var(--accent); }
        p. subtitle { color: var(--text-muted); font-size: 15px; margin-bottom: 30px; }

        /* INPUT FIELD */
        . input-group {
            position: relative;
            margin-bottom: 20px;
            background:  var(--card-bg);
            border-radius: var(--radius);
            padding: 4px;
            border: 1px solid var(--border);
            transition: border-color 0.2s;
        }

        .input-group:focus-within { border-color: var(--accent); }

        input {
            width: 100%;
            background: transparent;
            border: none;
            padding: 16px;
            font-size: 16px;
            color: var(--text-main);
        }

        input::placeholder { color: #4a5568; }

        /* BUTTONS */
        .btn-main {
            width: 100%;
            background: var(--accent);
            color: white;
            border:  none;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            border-radius: var(--radius);
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        . btn-main:active { transform: scale(0.98); }
        .btn-main:disabled { background: var(--border); color: var(--text-muted); cursor: not-allowed; }

        /* STATUS & ANIMATIONS */
        .status-msg {
            margin-top: 15px;
            font-size:  14px;
            min-height: 20px;
            font-weight: 500;
            opacity: 0;
            transition:  opacity 0.3s;
        }
        .show-status { opacity: 1; }
        .error { color: var(--error); }
        .success { color: var(--success); }

        . spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
        }
        
        . spinner. hidden { display: none; }
        
        @keyframes spin { to { transform: rotate(360deg); } }

        /* RESULTS CARD */
        .result-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            margin-top: 30px;
            overflow: hidden;
            display: none; /* Hidden by default */
            border: 1px solid var(--border);
            text-align: left;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .video-info {
            display: flex;
            padding: 15px;
            gap: 15px;
            border-bottom: 1px solid var(--border);
        }

        .thumbnail {
            width: 80px;
            height: 60px;
            background: #000;
            border-radius:  6px;
            object-fit: cover;
        }

        .meta { display: flex; flex-direction: column; justify-content: center; }
        .video-title { font-size: 14px; font-weight: 600; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient:  vertical; overflow: hidden; }
        .video-duration { font-size: 12px; color: var(--text-muted); margin-top: 4px; }

        . download-options { padding: 10px; }
        
        .option-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            margin-bottom:  5px;
            background: rgba(255,255,255,0.03);
        }

        .fmt-info { display: flex; flex-direction: column; }
        .fmt-quality { font-size: 14px; font-weight: 700; color: var(--text-main); }
        .fmt-size { font-size: 12px; color: var(--text-muted); }

        . btn-dl {
            background: var(--success);
            color: #fff;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size:  13px;
            font-weight:  600;
            transition: opacity 0.2s;
            cursor: pointer;
            border: none;
            display: inline-block;
        }
        .btn-dl:hover { opacity: 0.9; }

        /* FOOTER & DISCLAIMER */
        . footer {
            margin-top:  auto;
            padding: 30px 20px;
            text-align: center;
            border-top: 1px solid var(--border);
            width: 100%;
            background: #0b0d10;
        }
        
        .disclaimer { font-size: 11px; color: #4a5568; line-height: 1.5; max-width: 600px; margin: 0 auto; }
        
        . monetize-link {
            display: inline-block;
            margin-top: 15px;
            color: var(--accent);
            font-size: 13px;
            text-decoration:  none;
            border-bottom: 1px dotted var(--accent);
        }

        /* Responsive */
        @media(max-width: 480px) {
            h1 { font-size: 24px; }
            .thumbnail { width: 70px; height: 70px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Zen<span class="logo-accent">Load</span></h1>
        <p class="subtitle">Download Video & Shorts (No Ads)</p>

        <div class="input-group">
            <input type="text" id="urlInput" placeholder="Paste YouTube link here..." autocomplete="off">
        </div>

        <button class="btn-main" id="fetchBtn" onclick="processVideo()">
            <span class="btn-text">Download</span>
            <div class="spinner" id="spinner"></div>
        </button>

        <div id="statusMsg" class="status-msg"></div>

        <div id="resultCard" class="result-card">
            <div class="video-info">
                <img id="thumbImg" class="thumbnail" src="" alt="Thumbnail">
                <div class="meta">
                    <div id="vidTitle" class="video-title">... </div>
                    <div id="vidDuration" class="video-duration">...</div>
                </div>
            </div>
            <div id="downloadList" class="download-options">
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="disclaimer">
            <strong>Legal Disclaimer:</strong> This tool is for personal and educational use only. 
            Do not download copyrighted material without permission. We do not host any files.  
            Users are solely responsible for their actions.
            <br><br>
            <a href="#" class="monetize-link" onclick="alert('This would link to BuyMeACoffee or a VPN affiliate.')">Support Development</a>
        </div>
    </footer>

    <script>
        // === CORE CONFIGURATION ===
        // We use public Invidious instances to fetch metadata without a backend. 
        // This is the "Zero Budget" secret. 
        const INSTANCES = [
            'https://invidious.jing.rocks',
            'https://vid.puffyan.us',
            'https://inv.tux.pizza',
            'https://invidious.nerdvpn.de',
            'https://invidious. drgns.space'
        ];

        let currentInstanceIndex = 0;

        // === DOM ELEMENTS ===
        const urlInput = document.getElementById('urlInput');
        const fetchBtn = document.getElementById('fetchBtn');
        const btnText = document.querySelector('.btn-text');
        const spinner = document.getElementById('spinner');
        const statusMsg = document.getElementById('statusMsg');
        const resultCard = document.getElementById('resultCard');
        const downloadList = document.getElementById('downloadList');

        // === UTILITY FUNCTIONS ===

        function updateStatus(msg, type = 'neutral') {
            statusMsg.textContent = msg;
            statusMsg.className = 'status-msg show-status ' + type;
        }

        /**
         * Extract YouTube video ID from various URL formats: 
         * - Standard:  youtube.com/watch?v=ID
         * - Short: youtu.be/ID
         * - Embed: youtube.com/embed/ID
         * - Shorts: youtube.com/shorts/ID
         * - Mobile: m.youtube.com/watch?v=ID
         */
        function extractVideoID(url) {
            if (! url || typeof url !== 'string') return false;
            
            // Matches:  youtu.be/ID, /shorts/ID, /embed/ID, /v/ID, watch?v=ID, watch?... &v=ID
            const regExp = /(? :youtu\.be\/|\/shorts\/|\/embed\/|\/v\/|watch\?(? :[^&]*&)*v=)([a-zA-Z0-9_-]{11})/;
            const match = url.match(regExp);
            
            return (match && match[1]) ? match[1] : false;
        }

        /**
         * Convert seconds to HH:MM:SS or MM:SS format
         */
        function secondsToTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            
            seconds = Math.floor(Number(seconds));
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;

            const padZero = (num) => (num < 10 ? '0' : '') + num;
            
            if (hours > 0) {
                return `${hours}:${padZero(minutes)}:${padZero(secs)}`;
            }
            return `${minutes}:${padZero(secs)}`;
        }

        /**
         * Fetch video metadata with retry logic across multiple Invidious instances
         */
        async function fetchWithRetry(videoId) {
            const errors = [];
            
            // Try each instance in round-robin fashion
            for (let i = 0; i < INSTANCES.length; i++) {
                const instance = INSTANCES[currentInstanceIndex];
                const apiUrl = `${instance}/api/v1/videos/${videoId}`;
                
                console.log(`Attempting to fetch from:  ${instance}`);
                
                try {
                    const response = await fetch(apiUrl, {
                        method: 'GET',
                        headers: { 'Accept': 'application/json' }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const data = await response.json();
                    if (! data || typeof data !== 'object') {
                        throw new Error('Invalid response format');
                    }
                    
                    console.log('Successfully fetched from:', instance);
                    return data;
                    
                } catch (error) {
                    const errorMsg = `${instance}:  ${error.message}`;
                    console.warn(errorMsg);
                    errors.push(errorMsg);
                    
                    // Rotate to next instance
                    currentInstanceIndex = (currentInstanceIndex + 1) % INSTANCES.length;
                }
            }
            
            // All instances failed
            const allErrors = errors.join(' | ');
            throw new Error(`All instances failed.  [${allErrors}]`);
        }

        /**
         * Main video processing function
         */
        async function processVideo() {
            const url = urlInput.value.trim();
            const videoId = extractVideoID(url);

            // Reset UI
            resultCard.style.display = 'none';
            downloadList.innerHTML = '';
            statusMsg.className = 'status-msg';
            
            if (!videoId) {
                updateStatus('Invalid YouTube URL.  Please check and try again.', 'error');
                return;
            }

            // Start Loading
            fetchBtn.disabled = true;
            btnText.style.display = 'none';
            spinner.classList.remove('hidden');
            updateStatus('Connecting to secure server... ', 'neutral');

            try {
                const data = await fetchWithRetry(videoId);
                renderResult(data);
                updateStatus('Ready to download', 'success');
            } catch (err) {
                console.error('Processing error:', err);
                updateStatus('Failed to fetch video. Please try again later.', 'error');
            } finally {
                fetchBtn. disabled = false;
                btnText.style.display = 'block';
                spinner.classList.add('hidden');
            }
        }

        /**
         * Render video metadata and download options
         * Safely handles malformed or missing data from API
         */
        function renderResult(data) {
            try {
                // === VALIDATE RESPONSE ===
                if (! data || typeof data !== 'object') {
                    throw new Error('Invalid API response format');
                }

                // === POPULATE THUMBNAIL ===
                const thumbnails = Array.isArray(data.videoThumbnails) ?  data.videoThumbnails :  [];
                let thumbUrl = '';
                
                if (thumbnails.length > 0) {
                    const mediumThumb = thumbnails. find(t => t && t.quality === 'medium');
                    thumbUrl = (mediumThumb && mediumThumb.url) || (thumbnails[0] && thumbnails[0].url) || '';
                }
                
                document.getElementById('thumbImg').src = thumbUrl;
                document.getElementById('thumbImg').alt = data.title || 'Video thumbnail';

                // === POPULATE TITLE & DURATION ===
                document.getElementById('vidTitle').textContent = data.title || 'Unknown Title';
                document.getElementById('vidDuration').textContent = secondsToTime(data.lengthSeconds || 0);

                // === COLLECT DOWNLOAD OPTIONS ===
                const options = [];

                // 1. Format Streams (Combined video + audio in one file)
                const formatStreams = Array.isArray(data.formatStreams) ? data.formatStreams : [];
                formatStreams.forEach(fmt => {
                    if (fmt && fmt.container === 'mp4' && fmt.url) {
                        const resolution = fmt.resolution || 'Unknown';
                        const qualityValue = parseInt(fmt.resolution) || 0;
                        
                        options.push({
                            label: resolution,
                            type: 'Video + Audio',
                            size: fmt.size || 'Unknown',
                            url: fmt.url,
                            qualityVal: qualityValue
                        });
                    }
                });

                // 2. Adaptive Formats (Audio only - MP4A/M4A)
                const adaptiveFormats = Array.isArray(data.adaptiveFormats) ? data.adaptiveFormats : [];
                const audioFormat = adaptiveFormats.find(f => 
                    f && f.type && typeof f.type === 'string' && f.type.includes('audio') && f.url
                );
                
                if (audioFormat) {
                    options.push({
                        label: 'Audio Only',
                        type:  'M4A (Best Quality)',
                        size: audioFormat.size || 'Unknown',
                        url: audioFormat. url,
                        qualityVal: -1
                    });
                }

                // === SORT BY QUALITY (High to Low) ===
                options.sort((a, b) => b.qualityVal - a. qualityVal);

                // === RENDER OPTIONS ===
                if (options.length === 0) {
                    downloadList.innerHTML = `
                        <div style="padding: 15px; text-align: center; color: var(--text-muted);">
                            <p>No direct download links available for this video.</p>
                            <p style="font-size: 12px; margin-top: 8px;">This may be due to regional restrictions or API limitations.</p>
                        </div>
                    `;
                } else {
                    let html = '';
                    options.forEach(opt => {
                        html += `
                            <div class="option-row">
                                <div class="fmt-info">
                                    <span class="fmt-quality">${escapeHTML(opt.label)}</span>
                                    <span class="fmt-size">${escapeHTML(opt.type)} â€¢ ${escapeHTML(String(opt.size))}</span>
                                </div>
                                <a href="${escapeHTML(opt.url)}" 
                                   target="_blank" 
                                   rel="noopener noreferrer" 
                                   class="btn-dl" 
                                   onclick="return downloadFile(event, '${escapeHTML(opt. label)}')">
                                   Download
                                </a>
                            </div>
                        `;
                    });
                    downloadList.innerHTML = html;
                }

                resultCard.style.display = 'block';

            } catch (error) {
                console.error('Error rendering result:', error);
                updateStatus('Error displaying video info. Response format may be unsupported. ', 'error');
                resultCard.style.display = 'none';
            }
        }

        /**
         * Escape HTML to prevent XSS
         */
        function escapeHTML(text) {
            if (! text) return '';
            const map = {
                '&': '&amp;',
                '<':  '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return String(text).replace(/[&<>"']/g, m => map[m]);
        }

        /**
         * Handle download link clicks
         * Provides feedback on download initiation
         */
        function downloadFile(event, quality) {
            console.log(`Initiating download:  ${quality}`);
            // Allow the link to proceed naturally (opens in new tab via target="_blank")
            // In browsers, cross-origin file downloads may open a tab instead of saving
            return true;
        }

        // === EVENT LISTENERS ===

        /**
         * Auto-process when user pastes a YouTube URL
         */
        urlInput.addEventListener('paste', () => {
            setTi            
